function Ybus = getYbusMatrix(caseName)
bus = caseName.bus;
brch = caseName.branch;
nbus = size(bus,1);
nbrch = size(brch,1);
f = brch(:,1);
t = brch(:,2);
r = brch(:,3);
x = brch(:,4);
zb = r + 1j.*x;
Ys = 1./zb;
Ytt = Ys;
Yff = Ytt;
Yft = -Ys;
Ytf = -Ys;
Cf = sparse(1:nbrch,f,ones(nbrch,1),nbrch,nbus);
Ct = sparse(1:nbrch,t,ones(nbrch,1),nbrch,nbus);
i = [1:nbrch;1:nbrch]';
Yf = sparse(i,[f;t],[Yff;Yft],nbrch,nbus);
Yt = sparse(i,[f;t],[Ytf;Ytt],nbrch,nbus);
Ybus = Cf' * Yf + Ct' * Yt ;  